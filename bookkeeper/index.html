<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accounting Software for Small Cooperatives | Bookkeeper App</title>
    <link rel="shortcut icon" type="image/ico" href="images/bookkeeper-app.ico"/>
    <link rel="stylesheet" href="styles.css"/>
  </head>
  <body>
    <nav>
      <ul>
        <li><a href="#download">Download</a></li>
        <li><a href="#contact">Contact</a></li>
      </ul>
    </nav>
    <header>
      <h1>Simple Bookkeeping for Small Cooperatives</h1>
      <p>Stress less from creating trial balance and financial statements.</p>
      <a href="#download">Try it for Free</a>
    </header>
    <section id="download">
      <div class="download__container">
        <h1>Try it free for 1 month</h2>
        <div class="installers">
          <h4>Installers</h4>
          <ul>
            <li>
              <a href="https://drive.google.com/uc?export=download&id=1oiDQv7lRd6gGvo8YseCib6QZwazSvBip" target="_newtab">
                <div class="link">
                  <img src="images/install-setup-product.svg" class="link__icon"></img> <span class="link__icon-text">Bookkeeper</span>
                </div>
              </a>
            </li>
            <li>
              <a href="https://drive.google.com/uc?export=download&id=1MKW_aI8jj6rZyjCSRDCVUSpIMjOgL69y" target="_newtab">
                <div class="link">
                  <img src="images/install-setup-product.svg" class="link__icon"></img> <span class="link__icon-text">Bookkeeper Admin</span>
                </div>
              </a>
            </li>
            <li>
              <a href="https://downloads.mariadb.org/interstitial/mariadb-10.1.37/win32-packages/mariadb-10.1.37-win32.msi/from/https%3A//archive.mariadb.org/" target="_newtab">
                <div class="link">
                  <img src="images/install-setup-product.svg" class="link__icon"></img> <span class="link__icon-text">Database</span>
                </div>
              </a>
            </li>
          </ul>
        </div>
        <div class="manuals">
          <h4>Manuals</h4>
          <ul>
            <li>
              <a href="https://drive.google.com/file/d/1JkLF0Vi7UOgzM7QdwRPW9uHzDZiKE4Xt/view?usp=sharing" target="_newtab">
                <div class="link">
                  <img src="images/pdf-file.svg" class="link__icon"></img> <span class="link__icon-text">Installation Manual</span>
                </div>
              </a>
            </li>
            <li>
              <a href="https://drive.google.com/file/d/1lMJQ_wiNU3VYkT-ANwFPUgRsPnn-oOrX/view?usp=sharing" target="_newtab">
                <div class="link">
                  <img src="images/pdf-file.svg" class="link__icon"></img> <span class="link__icon-text">Users Manual</span>
                </div>
              </a>
            </li>
            <li>
              <a href="https://drive.google.com/file/d/1nXsSIICpKWqriHyLqXXdKPrOKBIDtm9e/view?usp=sharing" target="_newtab">
                <div class="link">
                  <img src="images/pdf-file.svg" class="link__icon"></img> <span class="link__icon-text">Backup and Restore</span>
                </div>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </section>
    <section id="contact">
      <div class="contact__container">
        <h1>Get in touch!</h1>
        <p>Send me your inquiry below and we will be in touch within one business day.</p>
        <form id="contact__form">
          <div>
            <label for="name">Name</label><br>
            <input type="text" id="name" name="name" required />
          </div>
          <div>
            <label for="email">Email</label><br>
            <input type="email" id="email" name="email" required />
          </div>
          <div>
            <label for="subject">Subject</label><br>
            <input type="text" id="subject" name="subject" required />
          </div>
          <div>
            <label for="message">Message</label><br>
            <textarea id="message" name="message" rows="5" required></textarea>
          </div>
          <button>
            <div>
              Submit <span class="loader hidden"></span>
            </div>
          </button>
        </form>
        <div class="message hidden">Thank you for getting in touch!</div>
      </div>
    </section>
    <footer>
      <img src="images/gmail.svg" class="icon"></img> <span class="icon-text">somozagenechristian@gmail.com</span>
    </footer>
  </body>
  <script>
    const contact__form = document.getElementById('contact__form');
    
    const displayLoader = function(isShow) {
      const loader = document.querySelector('#contact__form button .loader');
      if(isShow) {
        loader.classList.remove('hidden');
        loader.classList.add('show');
      }
      else {
        loader.classList.remove('show');
        loader.classList.add('hidden');
      }
    }
    
    const displayMessage = function(message, isSuccess) {
      const div = document.querySelector('.message');
      div.innerHTML = message;
      if(isSuccess) {
        div.classList.remove('text-danger');
        div.classList.add('text-success');
      }
      else {
        div.classList.remove('text-success');
        div.classList.add('text-danger');
      }
      div.classList.remove('hidden');
      div.classList.add('show');
      
      displayLoader(false);
    }
    
    const serialize = function (form) {
      var field,
        l,
        s = [];

      if (typeof form == 'object' && form.nodeName == "FORM") {
        let len = form.elements.length;

        for (let i = 0; i < len; i++) {
          field = form.elements[i];
          if (field.name && !field.disabled && field.type != 'button' && field.type != 'file' && field.type != 'hidden' && field.type != 'reset' && field.type != 'submit') {
            if (field.type == 'select-multiple') {
              l = form.elements[i].options.length;

              for (let j = 0; j < l; j++) {
                if (field.options[j].selected) {
                  s[s.length] = encodeURIComponent(field.name) + "=" + encodeURIComponent(field.options[j].value);
                }
              }
            }
            else if ((field.type != 'checkbox' && field.type != 'radio') || field.checked) {
              s[s.length] = encodeURIComponent(field.name) + "=" + encodeURIComponent(field.value);
            }
          }
        }
      }
      return s.join('&').replace(/%20/g, '+');
    };
    
    contact__form.addEventListener('submit', function (event) {
      displayLoader(true);
      
      event.preventDefault();
      const data = serialize(contact__form);
      const xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
          if(this.status == 200) {
            contact__form.reset();
            const message = 'Thank you for getting in touch!';
            displayMessage(message, true);
          }
          else {
            const message = "Something went wrong. Please try again.";
            const div = document.querySelector('.message');
            displayMessage(message, false);
          }
        }
      };
      xhttp.onerror = function() {
        const message = "Something went wrong. Please try again.";
        const div = document.querySelector('.message');
        displayMessage(message, false);
      };
      xhttp.open("POST", "https://script.google.com/macros/s/AKfycbwgQc_i2bFhtsN-fDXquUXFMPoNksYtVjmqYwn4a-LDylfWw2S_gZuRwVZPkkfJEK64ag/exec", true);
      xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
      xhttp.send(data);
    });
  </script>
</html>