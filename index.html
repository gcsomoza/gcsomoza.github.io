<!DOCTYPE html>

<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="shortcut icon" type="image/png" href="images/g-logo-circle-edited.png"/>
  <link rel="stylesheet" href="styles.css">
  <title>Gene Christian | Full Stack Web Developer</title>
</head>

<body>

  <header>
    <div class="avatar">
      <img src="images/dp.jpg" alt="" />
      <h3 class="name">Gene Christian</h3>
      <p class="post">Web Developer</p>
    </div>
    <nav class="navbar">
      <ul>
        <li><a href="#home">Home</a></li>
        <li><a href="#about">About</a></li>
        <li><a href="#contact">Contact</a></li>
      </ul>
    </nav>
  </header>

</body>

<script>
  const contact__form = document.getElementById('contact__form');
  
  const displayLoader = function(isShow) {
    const loader = document.querySelector('#contact__form button .loader');
    if(isShow) {
      loader.classList.remove('hidden');
      loader.classList.add('show');
    }
    else {
      loader.classList.remove('show');
      loader.classList.add('hidden');
    }
  }
  
  const displayMessage = function(message, isSuccess) {
    const div = document.querySelector('.message');
    div.innerHTML = message;
    if(isSuccess) {
      div.classList.remove('text-danger');
      div.classList.add('text-success');
    }
    else {
      div.classList.remove('text-success');
      div.classList.add('text-danger');
    }
    div.classList.remove('hidden');
    div.classList.add('show');
    
    displayLoader(false);
  }
  
  const serialize = function (form) {
    var field,
      l,
      s = [];

    if (typeof form == 'object' && form.nodeName == "FORM") {
      let len = form.elements.length;

      for (let i = 0; i < len; i++) {
        field = form.elements[i];
        if (field.name && !field.disabled && field.type != 'button' && field.type != 'file' && field.type != 'hidden' && field.type != 'reset' && field.type != 'submit') {
          if (field.type == 'select-multiple') {
            l = form.elements[i].options.length;

            for (let j = 0; j < l; j++) {
              if (field.options[j].selected) {
                s[s.length] = encodeURIComponent(field.name) + "=" + encodeURIComponent(field.options[j].value);
              }
            }
          }
          else if ((field.type != 'checkbox' && field.type != 'radio') || field.checked) {
            s[s.length] = encodeURIComponent(field.name) + "=" + encodeURIComponent(field.value);
          }
        }
      }
    }
    return s.join('&').replace(/%20/g, '+');
  };
  
  contact__form.addEventListener('submit', function (event) {
    displayLoader(true);
    
    event.preventDefault();
    const data = serialize(contact__form);
    const xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function() {
      if (this.readyState == 4 && this.status == 200) {
        if(this.status == 200) {
          contact__form.reset();
          const message = 'Thank you for getting in touch!';
          displayMessage(message, true);
        }
        else {
          const message = "Something went wrong. Please try again.";
          const div = document.querySelector('.message');
          displayMessage(message, false);
        }
      }
    };
    xhttp.onerror = function() {
      const message = "Something went wrong. Please try again.";
      const div = document.querySelector('.message');
      displayMessage(message, false);
    };
    xhttp.open("POST", "https://script.google.com/macros/s/AKfycbz8ljq414a1oOSFRKKDBkeujpVTtkRb7YnMyiX4mNK7Eme0nRl3euy4dEL8as0u6AsV/exec", true);
    xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    xhttp.send(data);
  });
</script>

</html>